<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>é›·è¾¾è®¾ç½®</title><style>*{margin:0;padding:0;box-sizing:border-box}html,body{margin:0;padding:0;height:100%}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:10px;color:#333;position:relative}.container{max-width:500px;margin:0 auto;background:rgba(255,255,255,.95);padding:20px;border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,.1);backdrop-filter:blur(10px)}h1{text-align:center;color:#4a5568;margin-bottom:30px;font-size:28px;font-weight:300}.section{margin-bottom:25px;padding:20px;background:rgba(255,255,255,.8);border-radius:15px;box-shadow:0 5px 15px rgba(0,0,0,.05)}.section h2{color:#2d3748;margin-bottom:20px;font-size:20px;font-weight:500;text-align:center}.form-group{margin-bottom:20px}label{display:block;margin-bottom:8px;font-weight:500;color:#4a5568;font-size:16px}input[type="range"]{width:100%;height:8px;border-radius:5px;background:#e2e8f0;outline:none;-webkit-appearance:none;margin:10px 0}input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:24px;height:24px;border-radius:50%;background:#667eea;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.2)}input[type="range"]::-moz-range-thumb{width:24px;height:24px;border-radius:50%;background:#667eea;cursor:pointer;border:none;box-shadow:0 2px 6px rgba(0,0,0,.2)}.range-value{text-align:center;font-size:18px;font-weight:600;color:#667eea;margin-top:5px}input[type="number"]{width:100%;padding:12px;border:2px solid #e2e8f0;border-radius:10px;font-size:16px;transition:border-color .3s ease}input[type="number"]:focus{border-color:#667eea;outline:none}select{width:100%;padding:12px;border:2px solid #e2e8f0;border-radius:10px;font-size:16px;background-color:white;transition:border-color .3s ease;appearance:none;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23667eea' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right 12px center;background-size:16px}select:focus{border-color:#667eea;outline:none}.upload-btn{width:100%;padding:12px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;border:none;border-radius:10px;font-size:16px;font-weight:500;cursor:pointer;transition:transform .2s ease;margin-bottom:10px}.upload-btn:hover{transform:translateY(-2px)}.upload-btn:active{transform:translateY(0)}button{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:12px 24px;border:none;border-radius:10px;cursor:pointer;margin:5px;font-size:16px;font-weight:500;transition:transform .2s ease;flex:1}button:hover{transform:translateY(-2px)}button:active{transform:translateY(0)}.button-group{display:flex;gap:10px;margin-top:20px}.audio-controls{display:flex;gap:10px;margin-top:10px}.audio-controls button{flex:1}.success{color:#38a169;background:rgba(56,161,105,.1);padding:10px;border-radius:8px;text-align:center;margin:10px 0}.error{color:#e53e3e;background:rgba(229,62,62,.1);padding:10px;border-radius:8px;text-align:center;margin:10px 0}.hidden{display:none}#message{position:fixed!important;top:20px!important;left:50%!important;transform:translateX(-50%)!important;z-index:9999!important;min-width:300px;max-width:500px;padding:0;margin:0;border:none;background:transparent;display:none;transition:all .3s ease}#message.show{display:block!important}#message .success,#message .error{padding:12px 20px;border-radius:8px;text-align:center;font-weight:bold;box-shadow:0 4px 12px rgba(0,0,0,.15);margin:0;border:none}#message .success{background:#4CAF50;color:white}#message .error{background:#f44336;color:white}@media (max-width:480px){.container{margin:5px;padding:15px}h1{font-size:24px}.section{padding:15px}.button-group{flex-direction:column}button{margin:5px 0}}</style></head><body><div id="message"></div><div class="container"><h1>ğŸ¯ é›·è¾¾è®¾ç½®</h1><div class="section"><h2>ğŸ“ åŸºç¡€è®¾ç½®</h2><div class="form-group"><label for="detectionDistance">æ£€æµ‹è·ç¦»: <span id="detectionDistanceValue">50</span> m</label><input type="range" id="detectionDistance" min="1" max="100" value="50" oninput="updateRangeValue('detectionDistance','detectionDistanceValue','m')"></div><div class="form-group"><label for="detectionSpeed">æ£€æµ‹é€Ÿåº¦: <span id="detectionSpeedValue">5</span> km/h</label><input type="range" id="detectionSpeed" min="1" max="120" value="5" oninput="updateRangeValue('detectionSpeed','detectionSpeedValue','km/h')"></div><div class="form-group"><label for="dangerDistance">å±é™©è·ç¦»: <span id="dangerDistanceValue">20</span> m</label><input type="range" id="dangerDistance" min="1" max="50" value="20" oninput="updateRangeValue('dangerDistance','dangerDistanceValue','m')"></div><div class="form-group"><label for="dangerSpeed">å±é™©é€Ÿåº¦: <span id="dangerSpeedValue">25</span> km/h</label><input type="range" id="dangerSpeed" min="10" max="120" value="25" oninput="updateRangeValue('dangerSpeed','dangerSpeedValue','km/h')"></div><div class="button-group"><button onclick="saveConfig()">ğŸ’¾ ä¿å­˜é…ç½®</button></div></div><div class="section"><h2>ğŸ’¡ ç¯å…‰è®¾ç½®</h2><div class="form-group"><label for="ledBlinkMode">ç¯å…‰æ¨¡å¼:</label><select id="ledBlinkMode" onchange="toggleBlinkSettings()"><option value="false">å¸¸äº®</option><option value="true">é—ªçƒ</option></select></div><div id="blinkSettingsContainer" style="display:none"><div class="form-group"><label for="normalBlinkInterval">æ™®é€šé¢‘ç‡ (ms):</label><input type="number" id="normalBlinkInterval" min="100" max="2000" value="800"></div><div class="form-group"><label for="dangerBlinkInterval">å±é™©é¢‘ç‡ (ms):</label><input type="number" id="dangerBlinkInterval" min="50" max="1000" value="120"></div></div><div class="button-group"><button onclick="saveConfig()">ğŸ’¾ ä¿å­˜é…ç½®</button></div></div><div class="section"><h2>ğŸ”Š éŸ³æ•ˆè®¾ç½®</h2><div class="form-group"><label for="warningGain">éŸ³æ•ˆéŸ³é‡:</label><input type="number" id="warningGain" min="0" max="10" step="0.1" value="3.0"></div><div class="form-group"><label>æ™®é€šéŸ³æ•ˆ:</label><input type="file" id="normalAudioFile" accept=".mp3" class="hidden" onchange="uploadAudioFile('normal')"><div class="audio-controls"><button type="button" class="upload-btn" onclick="document.getElementById('normalAudioFile').click()">ğŸ“ ä¸Šä¼ éŸ³æ•ˆ (MP3)</button><button type="button" class="upload-btn" onclick="playAudio('normal')">ğŸ”Š è¯•å¬</button></div><div id="normalAudioStatus"></div></div><div class="form-group"><label>å±é™©éŸ³æ•ˆ:</label><input type="file" id="dangerAudioFile" accept=".mp3" class="hidden" onchange="uploadAudioFile('danger')"><div class="audio-controls"><button type="button" class="upload-btn" onclick="document.getElementById('dangerAudioFile').click()">ğŸ“ ä¸Šä¼ éŸ³æ•ˆ (MP3)</button><button type="button" class="upload-btn" onclick="playAudio('danger')">ğŸ”Š è¯•å¬</button></div><div id="dangerAudioStatus"></div></div><div class="button-group"><button onclick="saveConfig()">ğŸ’¾ ä¿å­˜é…ç½®</button></div></div></div><script>function updateRangeValue(sliderId,valueId,unit){const slider=document.getElementById(sliderId);const valueSpan=document.getElementById(valueId);valueSpan.textContent=slider.value}function uploadAudioFile(type){const fileInput=document.getElementById(type+'AudioFile');const file=fileInput.files[0];if(!file){return}const formData=new FormData();const fileName=type==='normal'?'normal.mp3':'danger.mp3';formData.append('file',file,fileName);const statusDiv=document.getElementById(type+'AudioStatus');statusDiv.innerHTML='<div class="success">æ­£åœ¨ä¸Šä¼ ...</div>';fetch('/upload',{method:'POST',body:formData}).then(response=>response.text()).then(data=>{statusDiv.innerHTML='<div class="success">âœ… ä¸Šä¼ æˆåŠŸ</div>';setTimeout(()=>{statusDiv.innerHTML=''},3000)}).catch(error=>{statusDiv.innerHTML='<div class="error">âŒ ä¸Šä¼ å¤±è´¥: '+error+'</div>'})}async function saveConfig(){const config={detectionDistance:parseInt(document.getElementById('detectionDistance').value),detectionSpeed:parseInt(document.getElementById('detectionSpeed').value),dangerDistance:parseInt(document.getElementById('dangerDistance').value),dangerSpeed:parseInt(document.getElementById('dangerSpeed').value),ledBlinkMode:document.getElementById('ledBlinkMode').value==='true',normalBlinkInterval:parseInt(document.getElementById('normalBlinkInterval').value),dangerBlinkInterval:parseInt(document.getElementById('dangerBlinkInterval').value),warningGain:parseFloat(document.getElementById('warningGain').value)};try{const response=await fetch('/config',{method:'POST',headers:{'Content-Type':'application/json',},body:JSON.stringify(config)});if(!response.ok)throw new Error();showMessage('âœ… é…ç½®ä¿å­˜æˆåŠŸ','success')}catch(e){showMessage('âŒ é…ç½®ä¿å­˜å¤±è´¥','error')}}async function loadConfig(){try{const response=await fetch('/config');if(!response.ok)throw new Error();const config=await response.json();document.getElementById('detectionDistance').value=config.detectionDistance||50;document.getElementById('detectionSpeed').value=config.detectionSpeed||5;document.getElementById('dangerDistance').value=config.dangerDistance||20;document.getElementById('dangerSpeed').value=config.dangerSpeed||25;document.getElementById('ledBlinkMode').value=(config.ledBlinkMode||false).toString();document.getElementById('normalBlinkInterval').value=config.normalBlinkInterval||800;document.getElementById('dangerBlinkInterval').value=config.dangerBlinkInterval||120;document.getElementById('warningGain').value=config.warningGain||3.5;updateRangeValue('detectionDistance','detectionDistanceValue','m');updateRangeValue('detectionSpeed','detectionSpeedValue','km/h');updateRangeValue('dangerDistance','dangerDistanceValue','m');updateRangeValue('dangerSpeed','dangerSpeedValue','km/h');toggleBlinkSettings();showMessage('âœ… é…ç½®åŠ è½½æˆåŠŸ','success')}catch(e){showMessage('âŒ é…ç½®åŠ è½½å¤±è´¥','error')}}function toggleBlinkSettings(){const blinkMode=document.getElementById('ledBlinkMode').value==='true';document.getElementById('blinkSettingsContainer').style.display=blinkMode?'block':'none'}function playAudio(type){const timestamp=new Date().getTime();const audioUrl=type==='normal'?`/normal.mp3?t=${timestamp}`:`/danger.mp3?t=${timestamp}`;const audio=new Audio(audioUrl);audio.play().then(()=>{showMessage(`ğŸ”Š æ­£åœ¨æ’­æ”¾${type==='normal'?'æ™®é€š':'å±é™©'}éŸ³æ•ˆ`,'success')}).catch(error=>{showMessage(`âŒ æ’­æ”¾${type==='normal'?'æ™®é€š':'å±é™©'}éŸ³æ•ˆå¤±è´¥`,'error')})}function showMessage(message,type){const messageDiv=document.getElementById('message');messageDiv.innerHTML=`<div class="${type}">${message}</div>`;messageDiv.classList.add('show');setTimeout(()=>{messageDiv.classList.remove('show');setTimeout(()=>{messageDiv.innerHTML=''},300)},3000)}window.onload=function(){loadConfig()};</script></body></html>